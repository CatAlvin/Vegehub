<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vegetable Visualization</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        display: flex;
        color: #333;
        overflow: hidden;
      }
      h1 {
        margin-top: 0px;
        margin-bottom: 20px;
      }
      header {
        background-color: #ff5f00;
        color: white;
        padding: 10px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        position: fixed;
        top: 0;
        z-index: 1000;
      }
      header span {
        height: 40px;
        font-size: 30px;
        color: white;
      }
      header .admin-icon {
        width: 40px;
        height: 40px;
        background-color: white;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-right: 25px;
      }
      .sidebar {
        background-color: #002379;
        color: white;
        width: 200px;
        padding-top: 60px; /* To push the sidebar content below the header */
        position: fixed;
        top: -0;
        left: 0;
        height: 100%;
        box-sizing: border-box;
        z-index: 999;
      }
      .sidebar a {
        display: block;
        color: white;
        padding: 15px 20px;
        text-decoration: none;
      }
      .sidebar a:hover {
        background-color: #1890fa;
        transition: background-color 0.3s;
      }
      .main-area {
        margin-left: 200px;
        margin-top: 60px; /* To push the main content below the header */
        padding: 20px;
        background-color: #f4f4f4;
        width: 100%;
        height: 100vh;
        box-sizing: border-box;
        overflow-y: auto;
      }
      select {
        padding: 10px;
        font-size: 16px;
        margin-right: 10px;
      }
      button {
        padding: 10px 20px;
        font-size: 16px;
        background-color: #ff5f00;
        color: white;
        border: none;
        cursor: pointer;
      }
      button:hover {
        background-color: #ff7f50;
      }
      #imgContainer img {
        max-width: 100%;
        height: auto;
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <header>
      <span>ğŸ¥¬Vegehub Admin</span>
      <div class="admin-icon">ğŸ§‘â€ğŸ’»</div>
    </header>
    <div class="sidebar">
      <a href="#" class="active-sidebar">ğŸ–Š è”¬èœè¯„ä»·</a>
      <a href="#">ï¼‹ æ–°å¢ç®¡ç†å‘˜</a>
    </div>
    <div class="main-area">
      <h1>Select Visualization Image</h1>
      <div>
        <label for="imgSelect">Select Image Type:</label>
        <select id="imgSelect">
          <option value="">Select an Image</option>
          <option value="customer_gender_age_butterfly_chart">
            Customer Gender Age Butterfly Chart
          </option>
          <option value="vegetable_season_chart">Vegetable Season Chart</option>
          <option value="sell_cost_chart">Sell Cost Chart</option>
          <option value="supplier_profile_chart">Supplier Profile Chart</option>
          <option value="vegetable_inventory_chart">
            Vegetable Inventory Chart
          </option>
          <option value="vegetable_region_chart">Vegetable Region Chart</option>
        </select>
      </div>
      <h5></h5>
      <div>
        <label for="vegeSelect">Select Vegetable:</label>
        <select id="vegeSelect" disabled>
          <option value="">Select a Vegetable</option>
          <option value="1">è¥¿çº¢æŸ¿</option>
          <option value="2">é»„ç“œ</option>
          <option value="3">èŒ„å­</option>
          <option value="4">åœŸè±†</option>
          <option value="5">èƒ¡èåœ</option>
          <option value="6">ç™½èœ</option>
          <option value="7">é’èœ</option>
          <option value="8">èŠ¹èœ</option>
          <option value="9">è´è‹£</option>
          <option value="10">ç”Ÿèœ</option>
          <option value="11">è èœ</option>
          <option value="12">è‹‹èœ</option>
          <option value="13">é¦™èœ</option>
          <option value="14">èŠ«è½</option>
          <option value="15">è‘±</option>
          <option value="16">å§œ</option>
          <option value="17">è’œ</option>
          <option value="18">è¾£æ¤’</option>
          <option value="19">æ¤’</option>
          <option value="20">è±†è§’</option>
          <option value="21">è±†èŠ½</option>
          <option value="22">è±†è‹—</option>
          <option value="23">ç”œæ¤’</option>
          <option value="24">è‹¦ç“œ</option>
          <option value="25">å—ç“œ</option>
          <option value="26">å†¬ç“œ</option>
          <option value="27">ä¸ç“œ</option>
          <option value="28">é»„èŠ±èœ</option>
          <option value="29">è²è—•</option>
          <option value="30">è¸è </option>
          <option value="31">èŠ‹å¤´</option>
          <option value="32">å±±è¯</option>
          <option value="33">èŠ±ç”Ÿ</option>
          <option value="34">èš•è±†</option>
          <option value="35">è±Œè±†</option>
          <option value="36">æ‰è±†</option>
        </select>
      </div>
      <button id="submitBtn">Get Image</button>
      <div id="imgContainer"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const imgSelect = document.getElementById('imgSelect');
            const vegeSelect = document.getElementById('vegeSelect');
            const submitBtn = document.getElementById('submitBtn');
            const imgContainer = document.getElementById('imgContainer');

            const imgNeedsVege = ['vegetable_season_chart', 'sell_cost_chart', 'vegetable_region_chart'];

            imgSelect.addEventListener('change', () => {
                if (imgNeedsVege.includes(imgSelect.value)) {
                    vegeSelect.disabled = false;
                } else {
                    vegeSelect.disabled = true;
                    vegeSelect.value = '';
                }
            });

            submitBtn.addEventListener('click', (event) => {
                event.preventDefault();
                const imgName = imgSelect.value;
                const vegeId = vegeSelect.value;
                
                if (!imgName) {
                    alert('Please select an image type.');
                    return;
                }

                let url = `http://localhost:8000/visualization/${imgName}`;
                if (imgNeedsVege.includes(imgName) && vegeId) {
                    url += `/${vegeId}`;
                } else {
                    url += `/100`;
                }

                const xhr = new XMLHttpRequest();
                xhr.open('GET', url, true);
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === XMLHttpRequest.DONE) {
                        if (xhr.status === 200) {
                            const data = JSON.parse(xhr.responseText);
                            imgContainer.innerHTML = `<h2>${data.vegetable_name || imgName}</h2><img src="${data.img_path}" alt="${imgName}">`;
                        } else {
                            console.error('Error fetching image:', xhr.status, xhr.statusText);
                        }
                    }
                };
                xhr.send();
            });
        });
        // é˜»æ­¢è¡¨å•é»˜è®¤æäº¤è¡Œä¸º
        document.getElementById('submitBtn').addEventListener('click', function(event) {
            event.preventDefault();
        });
        // é˜»æ­¢ç•Œé¢åˆ·æ–°
        window.onbeforeunload = function() {
            return 'Are you sure you want to leave?';
        };
    </script>
  </body>
</html>
